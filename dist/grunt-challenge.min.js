/*! grunt-challenge 12-12-2014 */
"use strict";function flipTile(a,b){b.fadeOut(100,function(){a.clicked?b.attr("src","img/tile-back.png"):b.attr("src",a.src),a.clicked=!a.clicked,b.fadeIn(100)})}function onTimer(){seconds=Math.floor((_.now()-startTime)/1e3),$("#time").text("You've been playing for "+seconds+" seconds!")}function stopTimer(){window.clearInterval(timer)}var tileBank=[],idx,timer,startTime,seconds;for(idx=1;32>=idx;idx++)tileBank.push({num:idx,src:"img/tile"+idx+".jpg",matched:!1,clicked:!1});$(document).ready(function(){$("#start").click(function(){seconds=0;var a=0,b=0,c=8;$("#game-board").css("display","none"),$("#game-board").empty(),$("#game-board").css("display","inline"),$("#win").css("display","none"),$("#found").text("Pairs found: "),$("#remain").text("Pairs left: "),$("#attempts").text("Number of turns: "),startTime=_.now(),timer=window.setInterval(onTimer,1e3);var d=[];tileBank=_.shuffle(tileBank),d=tileBank.slice(0,8),_.forEach(d,function(a){a.clicked=!1,a.matched=!1,d.push(_.clone(a))}),d=_.shuffle(d);var e=$("#game-board"),f=$(document.createElement("div"));_.forEach(d,function(a,b){b>0&&b%4==0&&(e.append(f),f=$(document.createElement("div")));var c=$(document.createElement("img"));c.attr("src","img/tile-back.png"),c.attr("alt","tile "+a.num),c.attr("width","250px"),c.data("tile",a),f.append(c)}),e.append(f);var g,h,i=0,j=null;$("#game-board img").click(function(){return null!=j?void(g.clicked||window.setTimeout(function(){clearTimeout(j),j=null},1e3)):void($(this).data("tile").clicked||(i++,i%2!=0&&(g=$(this),flipTile(g.data("tile"),g)),i%2==0&&(h=$(this),flipTile(h.data("tile"),h),g.data("tile").num==h.data("tile").num?(b++,c--,$("#found").text("Pairs found: "+b),$("#remain").text("Pairs left: "+c),g.matched=!0,h.matched=!0):j=window.setTimeout(function(){a++,flipTile(g.data("tile"),g),flipTile(h.data("tile"),h),$("#attempts").text("Number of turns: "+a),j=null},1e3)),8==b&&(stopTimer(),$("#game-board").text("You win!"),$("#win").css("display","block"))))})})});